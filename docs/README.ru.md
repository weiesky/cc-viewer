# CC-Viewer

Система мониторинга запросов для Claude Code, которая перехватывает и визуализирует все API-запросы и ответы в реальном времени. Помогает разработчикам отслеживать их Context для просмотра и отладки во время Vibe Coding.

[简体中文](./README.zh.md) | [繁體中文](./README.zh-TW.md) | [한국어](./README.ko.md) | [日本語](./README.ja.md) | [Deutsch](./README.de.md) | [Español](./README.es.md) | [Français](./README.fr.md) | [Italiano](./README.it.md) | [Dansk](./README.da.md) | [Polski](./README.pl.md) | [Русский](./README.ru.md) | [العربية](./README.ar.md) | [Norsk](./README.no.md) | [Português (Brasil)](./README.pt-BR.md) | [ไทย](./README.th.md) | [Türkçe](./README.tr.md) | [Українська](./README.uk.md)

## Использование

```bash
npm install -g cc-viewer
```

После установки выполните:

```bash
ccv
```

Эта команда автоматически настраивает локально установленный Claude Code для мониторинга и добавляет hook автоматического восстановления в конфигурацию вашей оболочки (`~/.zshrc` или `~/.bashrc`). Затем используйте Claude Code как обычно и откройте `http://localhost:7008` в браузере для просмотра интерфейса мониторинга.

После обновления Claude Code никаких ручных действий не требуется — при следующем запуске `claude` автоматически обнаружит и повторно настроит.

### Удаление

```bash
ccv --uninstall
```

## Возможности

### Мониторинг запросов (Raw Mode)

- Перехват в реальном времени всех API-запросов от Claude Code, включая потоковые ответы
- Левая панель показывает метод запроса, URL, длительность и код статуса
- Автоматически определяет и помечает запросы Main Agent и Sub Agent (подтипы: Bash, Task, Plan, General)
- Правая панель поддерживает переключение вкладок Request / Response
- Request Body по умолчанию раскрывает `messages`, `system`, `tools` на один уровень
- Response Body по умолчанию полностью раскрыт
- Переключение между представлением JSON и обычным текстом
- Копирование содержимого JSON одним нажатием
- Запросы MainAgent поддерживают Body Diff JSON, отображая в свёрнутом виде отличия от предыдущего запроса MainAgent (только изменённые/добавленные поля)
- Подсказка Body Diff JSON может быть закрыта; после закрытия настройка сохраняется на сервере и больше не отображается

### Chat Mode

Нажмите кнопку "Chat mode" в правом верхнем углу, чтобы преобразовать полную историю диалога Main Agent в интерфейс чата:

- Сообщения пользователя выровнены по правому краю (синие пузыри), ответы Main Agent выровнены по левому краю (тёмные пузыри) с рендерингом Markdown
- Сообщения `/compact` автоматически определяются и отображаются в свёрнутом виде, нажмите для раскрытия полного резюме
- Результаты вызовов инструментов отображаются inline в соответствующем сообщении Assistant
- Блоки `thinking` свёрнуты по умолчанию, нажмите для раскрытия
- `tool_use` отображается как компактные карточки вызовов инструментов (Bash, Read, Edit, Write, Glob, Grep, Task имеют выделенное отображение)
- Сообщения выбора пользователя (AskUserQuestion) отображаются в формате вопрос-ответ
- Теги системные (`<system-reminder>`, `<project-reminder>` и т.д.) автоматически свёрнуты
- Системный текст автоматически фильтруется, показывая только реальный ввод пользователя
- Отображение с разделением на несколько сессий (автоматическая сегментация после `/compact`, `/clear` и т.д.)
- Каждое сообщение показывает временную метку с точностью до секунды

### Token Stats

Всплывающая панель в области заголовка:

- Количество Token, сгруппированное по модели (вход/выход)
- Количество создания/чтения Cache и процент попаданий в Cache
- Обратный отсчёт истечения Cache Main Agent

### Управление логами

Через выпадающее меню CC-Viewer в левом верхнем углу:

- Импорт локальных логов: просмотр исторических файлов логов, сгруппированных по проекту, открывается в новом окне
- Загрузить локальный JSONL файл: выбор и загрузка локального файла `.jsonl` (до 200МБ)
- Скачать текущий лог: скачать текущий файл лога мониторинга JSONL
- Экспорт пользовательских промптов: извлечение и отображение всех пользовательских вводов, с раскрываемым представлением system-reminder
- Экспорт промптов в TXT: экспорт пользовательских промптов в локальный файл `.txt`

### Многоязычная поддержка

CC-Viewer поддерживает 18 языков, автоматически переключаясь на основе системной локали:

简体中文 | English | 繁體中文 | 한국어 | Deutsch | Español | Français | Italiano | Dansk | 日本語 | Polski | Русский | العربية | Norsk | Português (Brasil) | ไทย | Türkçe | Українська

## License

MIT
