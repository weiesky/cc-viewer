# CC-Viewer

Система моніторингу запитів Claude Code, яка захоплює та візуально відображає всі API-запити та відповіді Claude Code в реальному часі (сирий текст, без цензури). Зручна для розробників, які хочуть моніторити свій Context, щоб переглядати та усувати проблеми під час Vibe Coding.

[English](../README.md) | [简体中文](./README.zh.md) | [繁體中文](./README.zh-TW.md) | [한국어](./README.ko.md) | [日本語](./README.ja.md) | [Deutsch](./README.de.md) | [Español](./README.es.md) | [Français](./README.fr.md) | [Italiano](./README.it.md) | [Dansk](./README.da.md) | [Polski](./README.pl.md) | [Русский](./README.ru.md) | [العربية](./README.ar.md) | [Norsk](./README.no.md) | [Português (Brasil)](./README.pt-BR.md) | [ไทย](./README.th.md) | [Türkçe](./README.tr.md) | Українська

## Використання

### Встановлення

```bash
npm install -g cc-viewer
```

### Запуск та автоматичне налаштування

```bash
ccv
```

Ця команда автоматично визначає метод встановлення локального Claude Code (NPM або Native Install) та адаптується відповідним чином.

- **Встановлення через NPM**: Автоматично впроваджує скрипт перехоплення в `cli.js` Claude Code.
- **Native Install**: Автоматично виявляє бінарний файл `claude`, налаштовує локальний прозорий проксі та встановлює Zsh Shell Hook для автоматичної пересилки трафіку.

### Перевизначення конфігурації (Configuration Override)

Якщо вам потрібно використовувати користувацьку кінцеву точку API (наприклад, корпоративний проксі), просто налаштуйте її в `~/.claude/settings.json` або встановіть змінну оточення `ANTHROPIC_BASE_URL`. `ccv` автоматично розпізнає це та коректно перешле запити.

### Тихий режим (Silent Mode)

За замовчуванням `ccv` працює в тихому режимі при обгортанні `claude`, забезпечуючи чистоту виводу терміналу та відповідність оригінальному досвіду. Всі логи захоплюються у фоновому режимі та доступні для перегляду на `http://localhost:7008`.

Після завершення налаштування використовуйте команду `claude` як зазвичай. Відвідайте `http://localhost:7008` для перегляду інтерфейсу моніторингу.

### Вирішення проблем (Troubleshooting)

- **Змішаний вивід (Mixed Output)**: Якщо ви бачите налагоджувальні логи `[CC-Viewer]` упереміш з виводом Claude, будь ласка, оновіться до останньої версії (`npm install -g cc-viewer`).
- **З'єднання відхилено (Connection Refused)**: Переконайтеся, що фоновий процес `ccv` запущений. Запуск `ccv` або `claude` (після встановлення Hook) повинен запустити його автоматично.
- **Порожнє тіло (Empty Body)**: Якщо ви бачите "No Body" у Viewer, це може бути пов'язано з нестандартними форматами SSE. Viewer тепер підтримує захоплення сирого контенту як резервний варіант.

### Видалення

```bash
ccv --uninstall
```

### Перевірка версії

```bash
ccv --version
```

## Можливості

### Моніторинг запитів (режим сирого тексту)
<img width="1500" height="720" alt="image" src="https://github.com/user-attachments/assets/519dd496-68bd-4e76-84d7-2a3d14ae3f61" />
- Захоплює всі API-запити від Claude Code в реальному часі, гарантуючи сирий текст, а не цензуровані логи (це дуже важливо!!!)
- Автоматично ідентифікує та позначає запити Main Agent та Sub Agent (підтипи: Bash, Task, Plan, General)
- Запити MainAgent підтримують Body Diff JSON, відображаючи у згорнутому вигляді відмінності від попереднього запиту MainAgent (лише змінені/додані поля)
- Кожен запит відображає вбудовану статистику використання Token (вхідні/вихідні токени, створення/читання кешу, відсоток влучень)
- Сумісність з Claude Code Router (CCR) та іншими проксі-сценаріями — запити визначаються за шаблоном шляху API як резервний метод

### Режим розмови

Натисніть кнопку «Режим розмови» у верхньому правому куті, щоб розібрати повну історію розмов Main Agent у інтерфейс чату:
<img width="1500" height="730" alt="image" src="https://github.com/user-attachments/assets/c973f142-748b-403f-b2b7-31a5d81e33e6" />


- Поки що не підтримує відображення Agent Team
- Повідомлення користувача вирівняні праворуч (сині бульбашки), відповіді Main Agent вирівняні ліворуч (темні бульбашки)
- Блоки `thinking` згорнуті за замовчуванням, відрендерені в Markdown, натисніть для розгортання та перегляду процесу мислення; підтримує переклад одним кліком (функція ще нестабільна)
- Повідомлення вибору користувача (AskUserQuestion) відображаються у форматі запитання-відповідь
- Двостороння синхронізація режимів: при перемиканні на режим розмови автоматично переходить до розмови, що відповідає вибраному запиту; при поверненні до режиму сирого тексту автоматично переходить до вибраного запиту
- Панель налаштувань: можна перемикати стан згортання за замовчуванням для результатів інструментів та блоків thinking


### Інструменти статистики

Спливаюча панель «Статистика даних» в області заголовка:
<img width="1500" height="729" alt="image" src="https://github.com/user-attachments/assets/b23f9a81-fc3d-4937-9700-e70d84e4e5ce" />

- Відображає кількість cache creation/read та відсоток влучень cache
- Статистика перебудови cache: відображає кількість та токени cache_creation, згруповані за причиною (TTL, зміна system/tools/model, скорочення/модифікація повідомлень, зміна key)
- Статистика використання інструментів: відображає частоту використання кожного інструменту, відсортовану за кількістю викликів
- Статистика використання Skill: відображає частоту використання кожного Skill, відсортовану за кількістю викликів
- Іконка концептуальної довідки (?): натисніть для перегляду вбудованої документації MainAgent, CacheRebuild та різних інструментів

### Керування логами

Через випадаюче меню CC-Viewer у верхньому лівому куті:
<img width="1200" height="672" alt="image" src="https://github.com/user-attachments/assets/8cf24f5b-9450-4790-b781-0cd074cd3b39" />

- Імпорт локальних логів: перегляд файлів історичних логів, згрупованих за проєктом, відкриття в новому вікні
- Завантаження локального JSONL файлу: безпосередній вибір локального файлу `.jsonl` для перегляду (підтримує до 500 МБ)
- Зберегти поточний лог як: завантаження поточного файлу логу моніторингу JSONL
- Об'єднання логів: об'єднання кількох файлів логів JSONL в одну сесію для єдиного аналізу
- Перегляд Prompt користувача: витяг та відображення всіх введень користувача, підтримує три режими перегляду — режим Оригінал (вихідний вміст), режим Контекст (системні теги згортаються), режим Текст (простий текст); слеш-команди (`/model`, `/context` тощо) відображаються як окремі записи; теги, пов'язані з командами, автоматично приховуються з вмісту Prompt
- Експорт Prompt у TXT: експорт Prompt користувача (простий текст, без системних тегів) у локальний файл `.txt`

### Багатомовна підтримка

CC-Viewer підтримує 18 мов, автоматично перемикаючись залежно від мови системи:

简体中文 | English | 繁體中文 | 한국어 | Deutsch | Español | Français | Italiano | Dansk | 日本語 | Polski | Русский | العربية | Norsk | Português (Brasil) | ไทย | Türkçe | Українська

## License

MIT
