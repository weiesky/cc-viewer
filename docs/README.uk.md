# CC-Viewer

Система моніторингу запитів Claude Code — в реальному часі перехоплює та візуалізує всі API-запити і відповіді Claude Code (оригінальний текст, без скорочень). Допомагає розробникам відстежувати свій контекст для перегляду та діагностики проблем у процесі Vibe Coding.

[English](../README.md) | [简体中文](./README.zh.md) | [繁體中文](./README.zh-TW.md) | [한국어](./README.ko.md) | [日本語](./README.ja.md) | [Deutsch](./README.de.md) | [Español](./README.es.md) | [Français](./README.fr.md) | [Italiano](./README.it.md) | [Dansk](./README.da.md) | [Polski](./README.pl.md) | [Русский](./README.ru.md) | [العربية](./README.ar.md) | [Norsk](./README.no.md) | [Português (Brasil)](./README.pt-BR.md) | [ไทย](./README.th.md) | [Türkçe](./README.tr.md) | Українська

## Використання

### Встановлення

```bash
npm install -g cc-viewer
```

### Запуск та автоматичне налаштування

```bash
ccv
```

Ця команда автоматично визначає спосіб встановлення локального Claude Code (NPM або Native Install) та адаптується відповідно.

- **NPM Install**: автоматично вставляє перехоплювальний скрипт у `cli.js` Claude Code.
- **Native Install**: автоматично виявляє бінарний файл `claude`, налаштовує локальний прозорий проксі та встановлює Zsh Shell Hook для автоматичного перенаправлення трафіку.

### Перевизначення конфігурації (Configuration Override)

Якщо вам потрібно використовувати власний API-ендпоінт (наприклад, корпоративний проксі), просто налаштуйте його у `~/.claude/settings.json` або встановіть змінну середовища `ANTHROPIC_BASE_URL`. `ccv` автоматично розпізнає та коректно перенаправить запити.

### Тихий режим (Silent Mode)

За замовчуванням `ccv` працює у тихому режимі під час обгортання `claude`, забезпечуючи чистий вивід у терміналі, ідентичний нативному досвіду. Всі логи перехоплюються у фоновому режимі та доступні за адресою `http://localhost:7008`.

Після налаштування просто використовуйте команду `claude` як зазвичай. Відвідайте `http://localhost:7008` для перегляду інтерфейсу моніторингу.

### Усунення несправностей (Troubleshooting)

Якщо у вас виникають проблеми із запуском, є універсальний спосіб діагностики:
Крок 1: відкрийте Claude Code у будь-якій директорії;
Крок 2: дайте Claude Code таку інструкцію:
```
Я встановив npm-пакет cc-viewer, але не можу його запустити. Перегляньте cli.js та findcc.js пакету cc-viewer і адаптуйте його до локального способу розгортання Claude Code відповідно до поточного середовища. Намагайтеся обмежити зміни файлом findcc.js.
```
Дозволити Claude Code самостійно перевірити помилки — набагато ефективніше, ніж питати когось або читати будь-яку документацію!

Після виконання цієї інструкції буде оновлено findcc.js. Якщо ваш проект часто потребує локального розгортання або форкнутий код регулярно стикається з проблемами встановлення — просто збережіть цей файл і наступного разу скопіюйте його напряму. На даному етапі багато проектів і компаній, що використовують Claude Code, розгортають його не на Mac, а на серверах, тому автор виніс findcc.js в окремий файл для зручного відстеження оновлень вихідного коду cc-viewer.

### Видалення

```bash
ccv --uninstall
```

### Перевірка версії

```bash
ccv --version
```

## Функції

### Моніторинг запитів (режим оригінального тексту)
<img width="1500" height="720" alt="image" src="https://github.com/user-attachments/assets/519dd496-68bd-4e76-84d7-2a3d14ae3f61" />
- Перехоплення в реальному часі всіх API-запитів, надісланих Claude Code — гарантовано оригінальний текст, а не скорочені логи (це важливо!!!)
- Автоматичне розпізнавання та маркування запитів Main Agent і Sub Agent (підтипи: Bash, Task, Plan, General)
- Підтримка Body Diff JSON для запитів MainAgent — згорнуте відображення відмінностей від попереднього запиту MainAgent (показуються лише змінені/нові поля)
- Вбудована статистика використання токенів для кожного запиту (вхідні/вихідні токени, створення/читання кешу, відсоток влучань)
- Сумісність з Claude Code Router (CCR) та іншими проксі-сценаріями — резервне зіставлення запитів за шаблоном API-шляху

### Режим діалогу

Натисніть кнопку «Режим діалогу» у верхньому правому куті, щоб розібрати повну історію розмови Main Agent у вигляді чату:
<img width="1500" height="730" alt="image" src="https://github.com/user-attachments/assets/c973f142-748b-403f-b2b7-31a5d81e33e6" />


- Відображення Agent Team наразі не підтримується
- Повідомлення користувача вирівняні праворуч (сині бульбашки), відповіді Main Agent — ліворуч (темні бульбашки)
- Блоки `thinking` згорнуті за замовчуванням, відображаються у Markdown; натисніть, щоб розгорнути та переглянути процес міркування; підтримується переклад в один клік (функція ще нестабільна)
- Повідомлення з вибором користувача (AskUserQuestion) відображаються у форматі запитання-відповідь
- Двостороння синхронізація режимів: перехід до режиму діалогу автоматично переміщує до розмови, що відповідає вибраному запиту; повернення до режиму оригінального тексту автоматично переміщує до вибраного запиту
- Панель налаштувань: можна перемикати стан згортання за замовчуванням для результатів інструментів та блоків thinking


### Інструменти статистики

Плаваюча панель «Статистика даних» в області Header:
<img width="1500" height="729" alt="image" src="https://github.com/user-attachments/assets/b23f9a81-fc3d-4937-9700-e70d84e4e5ce" />

- Відображення кількості створень/читань кешу та відсотка влучань
- Статистика перебудови кешу: кількість випадків та токени cache_creation, згруповані за причиною (TTL, зміна system/tools/model, скорочення/зміна повідомлень, зміна ключа)
- Статистика використання інструментів: частота виклику кожного інструменту, відсортована за кількістю викликів
- Статистика використання Skill: частота виклику кожного Skill, відсортована за кількістю викликів
- Іконка довідки (?): натисніть для перегляду вбудованої документації по MainAgent, CacheRebuild та кожному інструменту

### Управління логами

Через випадаюче меню CC-Viewer у верхньому лівому куті:
<img width="1200" height="672" alt="image" src="https://github.com/user-attachments/assets/8cf24f5b-9450-4790-b781-0cd074cd3b39" />

- Імпорт локальних логів: перегляд файлів історичних логів, згрупованих за проектом, відкриття в новому вікні
- Завантаження локального JSONL-файлу: безпосередній вибір локального файлу `.jsonl` для перегляду (підтримує до 500 МБ)
- Зберегти поточний лог як: завантаження поточного файлу логу моніторингу JSONL
- Об'єднання логів: об'єднання кількох файлів логів JSONL в одну сесію для єдиного аналізу
- Перегляд Prompt користувача: витяг та відображення всіх введень користувача, підтримує три режими перегляду — режим Оригінал (вихідний вміст), режим Контекст (системні теги згортаються), режим Текст (простий текст); слеш-команди (`/model`, `/context` тощо) відображаються як окремі записи; теги, пов'язані з командами, автоматично приховуються з вмісту Prompt
- Експорт Prompt у TXT: експорт Prompt користувача (простий текст, без системних тегів) у локальний файл `.txt`

### Багатомовна підтримка

CC-Viewer підтримує 18 мов, автоматично перемикаючись залежно від мови системи:

简体中文 | English | 繁體中文 | 한국어 | Deutsch | Español | Français | Italiano | Dansk | 日本語 | Polski | Русский | العربية | Norsk | Português (Brasil) | ไทย | Türkçe | Українська

## License

MIT
