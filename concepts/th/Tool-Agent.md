# Agent

## คำจำกัดความ

เริ่มต้น sub-agent (SubAgent) เพื่อจัดการงานหลายขั้นตอนที่ซับซ้อนอย่างอิสระ Sub-agent เป็นกระบวนการย่อยอิสระ แต่ละตัวมีชุดเครื่องมือและบริบทเฉพาะของตัวเอง Agent เป็นเวอร์ชันเปลี่ยนชื่อของเครื่องมือ Task ใน Claude Code เวอร์ชันใหม่

## พารามิเตอร์

| พารามิเตอร์ | ประเภท | จำเป็น | คำอธิบาย |
|------|------|------|------|
| `prompt` | string | ใช่ | คำอธิบายงานที่ sub-agent จะดำเนินการ |
| `description` | string | ใช่ | สรุปสั้น 3-5 คำ |
| `subagent_type` | string | ใช่ | ประเภท sub-agent กำหนดชุดเครื่องมือที่ใช้ได้ |
| `model` | enum | ไม่ | ระบุโมเดล (sonnet / opus / haiku) ค่าเริ่มต้นสืบทอดจากพาเรนต์ |
| `max_turns` | integer | ไม่ | จำนวนรอบ agentic สูงสุด |
| `run_in_background` | boolean | ไม่ | รันในเบื้องหลังหรือไม่ งานเบื้องหลังส่งคืนพาธ output_file |
| `resume` | string | ไม่ | ID ของ agent ที่จะกลับมาทำต่อ ดำเนินการต่อจากการรันครั้งก่อน มีประโยชน์สำหรับการกลับมาทำต่อ sub-agent ก่อนหน้าโดยไม่สูญเสียบริบท |
| `isolation` | enum | ไม่ | โหมดแยกส่วน `worktree` สร้าง git worktree ชั่วคราว |

## ประเภท Sub-agent

| ประเภท | วัตถุประสงค์ | เครื่องมือที่ใช้ได้ |
|------|------|----------|
| `Bash` | รันคำสั่ง การดำเนินการ git | Bash |
| `general-purpose` | งานทั่วไปหลายขั้นตอน | เครื่องมือทั้งหมด |
| `Explore` | สำรวจโค้ดเบสอย่างรวดเร็ว | ทั้งหมดยกเว้น Agent/Edit/Write/NotebookEdit/ExitPlanMode |
| `Plan` | ออกแบบแผนการดำเนินงาน | ทั้งหมดยกเว้น Agent/Edit/Write/NotebookEdit/ExitPlanMode |
| `claude-code-guide` | ถาม-ตอบเกี่ยวกับคู่มือการใช้ Claude Code | Glob, Grep, Read, WebFetch, WebSearch |
| `statusline-setup` | ตั้งค่าแถบสถานะ | Read, Edit |

## สถานการณ์การใช้งาน

**เหมาะสำหรับ:**
- งานซับซ้อนที่ต้องดำเนินการหลายขั้นตอนอย่างอิสระ
- การสำรวจและวิจัยเชิงลึกของโค้ดเบส (ใช้ประเภท Explore)
- งานคู่ขนานที่ต้องการสภาพแวดล้อมแยก
- งานที่ใช้เวลานานที่ต้องรันในเบื้องหลัง

**ไม่เหมาะสำหรับ:**
- อ่านพาธไฟล์เฉพาะ — ใช้ Read หรือ Glob โดยตรง
- ค้นหาใน 2-3 ไฟล์ที่รู้จัก — ใช้ Read โดยตรง
- ค้นหาคำจำกัดความคลาสเฉพาะ — ใช้ Glob โดยตรง

## ข้อควรระวัง

- หลังจากเสร็จสิ้น sub-agent จะส่งคืนข้อความเดียว ผลลัพธ์ไม่ปรากฏให้ผู้ใช้เห็น agent หลักต้องถ่ายทอดให้
- สามารถเริ่มการเรียก Agent หลายรายการพร้อมกันในข้อความเดียวเพื่อเพิ่มประสิทธิภาพ
- งานเบื้องหลังตรวจสอบความคืบหน้าผ่านเครื่องมือ TaskOutput
- ประเภท Explore ช้ากว่าการเรียก Glob/Grep โดยตรง ใช้เฉพาะเมื่อการค้นหาง่ายๆ ไม่เพียงพอ
- ใช้ `run_in_background: true` สำหรับงานที่ใช้เวลานานและไม่ต้องการผลลัพธ์ทันที ใช้โหมดเบื้องหน้า (ค่าเริ่มต้น) เมื่อต้องการผลลัพธ์ก่อนดำเนินการต่อ
- พารามิเตอร์ `resume` ช่วยให้สามารถดำเนินการต่อเซสชัน sub-agent ที่เริ่มไว้ก่อนหน้า โดยรักษาบริบทที่สะสมไว้

## ความสำคัญใน cc-viewer

Agent เป็นชื่อใหม่ของเครื่องมือ Task ใน Claude Code เวอร์ชันล่าสุด การเรียก Agent จะสร้างสายคำร้องขอ SubAgent ซึ่งสามารถเห็นในรายการคำร้องขอเป็นลำดับคำร้องขอย่อยที่แยกจาก MainAgent คำร้องขอ SubAgent มักมี system prompt แบบย่อและคำจำกัดความเครื่องมือน้อยกว่า ซึ่งแตกต่างอย่างชัดเจนจาก MainAgent ใน cc-viewer อาจแสดงชื่อเครื่องมือ `Task` หรือ `Agent` ขึ้นอยู่กับเวอร์ชัน Claude Code ที่ใช้ในการสนทนาที่บันทึกไว้
