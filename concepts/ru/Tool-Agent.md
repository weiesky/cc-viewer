# Agent

## Определение

Запускает суб-агента (SubAgent) для автономной обработки сложных многоэтапных задач. Суб-агент — это независимый подпроцесс с собственным набором инструментов и контекстом. Agent — это переименованная версия инструмента Task в новых версиях Claude Code.

## Параметры

| Параметр | Тип | Обязательный | Описание |
|------|------|------|------|
| `prompt` | string | Да | Описание задачи для выполнения суб-агентом |
| `description` | string | Да | Краткое резюме в 3-5 словах |
| `subagent_type` | string | Да | Тип суб-агента, определяет доступный набор инструментов |
| `model` | enum | Нет | Указание модели (sonnet / opus / haiku), по умолчанию наследуется от родителя |
| `max_turns` | integer | Нет | Максимальное количество агентных ходов |
| `run_in_background` | boolean | Нет | Запускать ли в фоне, фоновая задача возвращает путь output_file |
| `resume` | string | Нет | ID агента для возобновления, продолжение с последнего выполнения. Полезно для продолжения предыдущего суб-агента без потери контекста |
| `isolation` | enum | Нет | Режим изоляции, `worktree` создаёт временный git worktree |

## Типы суб-агентов

| Тип | Назначение | Доступные инструменты |
|------|------|----------|
| `Bash` | Выполнение команд, операции git | Bash |
| `general-purpose` | Общие многоэтапные задачи | Все инструменты |
| `Explore` | Быстрое исследование кодовой базы | Все инструменты кроме Agent/Edit/Write/NotebookEdit/ExitPlanMode |
| `Plan` | Проектирование плана реализации | Все инструменты кроме Agent/Edit/Write/NotebookEdit/ExitPlanMode |
| `claude-code-guide` | Вопросы и ответы по руководству Claude Code | Glob, Grep, Read, WebFetch, WebSearch |
| `statusline-setup` | Настройка строки состояния | Read, Edit |

## Сценарии использования

**Подходящее применение:**
- Сложные задачи, требующие многоэтапного автономного выполнения
- Исследование кодовой базы и глубокий анализ (тип Explore)
- Параллельная работа, требующая изолированной среды
- Длительные задачи, требующие фонового выполнения

**Неподходящее применение:**
- Чтение определённого пути файла — используйте Read или Glob напрямую
- Поиск в 2-3 известных файлах — используйте Read напрямую
- Поиск определения класса — используйте Glob напрямую

## Примечания

- После завершения суб-агент возвращает одно сообщение, его результаты не видны пользователю — основной агент должен их передать
- Можно параллельно запускать несколько вызовов Agent в одном сообщении для повышения эффективности
- Прогресс фоновых задач проверяется через инструмент TaskOutput
- Тип Explore медленнее прямого вызова Glob/Grep, используйте только когда простого поиска недостаточно
- Используйте `run_in_background: true` для длительных задач, не требующих немедленного результата; используйте режим переднего плана (по умолчанию), когда результат нужен перед продолжением
- Параметр `resume` позволяет продолжить ранее запущенную сессию суб-агента, сохраняя накопленный контекст

## Значение в cc-viewer

Agent — это новое название инструмента Task в последних версиях Claude Code. Вызов Agent порождает цепочку запросов SubAgent, видимую в списке запросов как независимая последовательность подзапросов, отделённая от MainAgent. Запросы SubAgent обычно имеют упрощённый system prompt и меньше определений инструментов, что явно отличает их от MainAgent. В cc-viewer могут отображаться названия инструментов `Task` или `Agent` в зависимости от версии Claude Code, использованной в записанной беседе.
